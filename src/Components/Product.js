import React, { useState } from "react";
import { useDispatch } from "react-redux";
import { addToCart } from "../redux/actions/productActions";
import { Link } from "react-router-dom";

const Product = ({ product }) => {
  const dispatch = useDispatch();
  const [count, setCount] = useState(0);
  const [isClicked, setIsClicked] = useState(false);
  const { id, title, price, category, image } = product;

  const cartButton = () => {
    dispatch(addToCart(product));
    setIsClicked(true);
    setCount((count) => count + 1);
  };

  return (
    <div className="border shadow flex flex-col items-center justify-between p-2">
      <div key={id} className="group relative mb-1">
        <div className="product-img text-center">
          <p className="text-lg font-bold text-gray-900 bg-blue-100 w-20 ">$ {price}</p>
          <img
          className=""
            src={image}
            alt={title}
          />
        </div>
        <div className="mt-8 flex justify-between">
          <div>
            <h3 className="text-sm text-gray-700 text-medium">
              <a href={product.href}>
                <span aria-hidden="true" />
                {title}
              </a>
            </h3>
          </div>
        </div>
      </div>
      <div className="w-full flex">
        <div>
            <Link className="w-full" to={`/product/${id}`}>
<svg className="h-7 w-7 mr-2" viewBox="0 0 512 480.83"><path d="M380.38 368.78c9.9 0 18.9 4.04 25.39 10.53a35.841 35.841 0 0 1 10.51 25.39c0 9.88-4.03 18.87-10.51 25.36a35.769 35.769 0 0 1-25.39 10.53c-9.89 0-18.86-4.02-25.37-10.53-6.51-6.49-10.54-15.48-10.54-25.36 0-9.9 4.02-18.88 10.53-25.38 6.53-6.53 15.49-10.54 25.38-10.54zm-149.46 84.43H31.51c-8.59 0-16.53-3.57-22.25-9.29C3.58 438.24 0 430.38 0 421.7V31.51C0 22.89 3.54 15.02 9.24 9.3l.06-.06C15.05 3.53 22.9 0 31.51 0h383.58c8.62 0 16.48 3.6 22.18 9.3 5.75 5.7 9.32 13.64 9.32 22.21v279.43c-9.73-3.41-19.66-6.14-29.71-8.14V31.51c0-.42-.23-.87-.6-1.23-.3-.36-.73-.56-1.19-.56H31.51c-.51 0-.96.19-1.25.48l-.06.06c-.29.29-.48.74-.48 1.25V421.7c0 .43.22.87.56 1.21.35.35.8.58 1.23.58h172.24c1.31 2.38 2.89 4.67 4.74 6.84 6.96 8.14 14.46 15.78 22.43 22.88zm-86.19-339.84h215.33c1.25 0 2.29 1.11 2.29 2.31v28.55c0 1.2-1.11 2.3-2.29 2.3H144.73c-1.17 0-2.29-1.03-2.29-2.3v-28.55c0-1.27 1.04-2.31 2.29-2.31zm0 193.81h175.5c-6.18 1.83-12.36 3.98-18.53 6.45-12.14 4.87-30.93 14.61-49.13 26.71H144.73c-1.19 0-2.29-1.04-2.29-2.3v-28.57a2.31 2.31 0 0 1 2.29-2.29zm-41.44-2.46c10.51 0 19.04 8.53 19.04 19.04 0 10.52-8.53 19.04-19.04 19.04s-19.04-8.52-19.04-19.04c0-10.51 8.53-19.04 19.04-19.04zm41.44-94.62h215.33c1.25 0 2.29 1.08 2.29 2.3v28.55c0 1.22-1.08 2.31-2.29 2.31H144.73c-1.2 0-2.29-1.04-2.29-2.31V212.4c0-1.27 1.04-2.3 2.29-2.3zm-41.44-2.46c10.51 0 19.04 8.52 19.04 19.03 0 10.52-8.53 19.05-19.04 19.05s-19.04-8.53-19.04-19.05c0-10.51 8.53-19.03 19.04-19.03zm0-96.73c10.51 0 19.04 8.53 19.04 19.04s-8.53 19.04-19.04 19.04-19.04-8.53-19.04-19.04 8.53-19.04 19.04-19.04zm147.84 287.63c31.66-38.28 72.71-68.93 123.86-69.99 54.28-1.13 99.43 31.28 134.78 70.13a8.601 8.601 0 0 1 .48 10.97c-29.89 42.16-77.07 70.86-129.62 71.17-54.09.31-96.84-29.45-130.01-71.02-2.7-3.4-2.4-8.22.51-11.26zm20.4 5.97c29.66 34.5 62.8 56.44 109.03 56.18 44.37-.26 82.11-20.95 108.74-55.59-31.3-32.69-67.27-57.4-113.97-56.44-43.66.92-75.76 23.96-103.8 55.85zm98.73-28.79c7.7 0 13.92 6.24 13.92 13.93 0 7.69-6.22 13.93-13.92 13.93-7.68 0-13.92-6.24-13.92-13.93 0-7.69 6.24-13.93 13.92-13.93z"/></svg>
            </Link>
          </div>
          {isClicked ? (
            <div>
              <button
                onClick={() => cartButton()}
                type="button"
                className="h-8 w-8 border border-transparent text-sm leading-4 font-medium w-full shadow-sm text-white hover:bg-teal-100 "
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path d="M 4 7 C 3.448 7 3 7.448 3 8 C 3 8.552 3.448 9 4 9 L 6.21875 9 L 8.84375 19.5 C 9.06675 20.39 9.86325 21 10.78125 21 L 13 21 L 22 21 L 23.25 21 C 24.152 21 24.91825 20.40125 25.15625 19.53125 L 27.75 10 L 25.65625 10 L 23.25 19 L 10.78125 19 L 8.15625 8.5 C 7.93425 7.61 7.13675 7 6.21875 7 L 4 7 z M 22 21 C 20.35499 21 19 22.35499 19 24 C 19 25.64501 20.35499 27 22 27 C 23.64501 27 25 25.64501 25 24 C 25 22.35499 23.64501 21 22 21 z M 13 21 C 11.35499 21 10 22.35499 10 24 C 10 25.64501 11.35499 27 13 27 C 14.64501 27 16 25.64501 16 24 C 16 22.35499 14.64501 21 13 21 z M 16 7 L 16 10 L 13 10 L 13 12 L 16 12 L 16 15 L 18 15 L 18 12 L 21 12 L 21 10 L 18 10 L 18 7 L 16 7 z M 13 23 C 13.564128 23 14 23.435872 14 24 C 14 24.564128 13.564128 25 13 25 C 12.435872 25 12 24.564128 12 24 C 12 23.435872 12.435872 23 13 23 z M 22 23 C 22.564128 23 23 23.435872 23 24 C 23 24.564128 22.564128 25 22 25 C 21.435872 25 21 24.564128 21 24 C 21 23.435872 21.435872 23 22 23 z" overflow="visible" font-family="Sans"/>
                </svg>
              </button>
              <span className="align-top py-1 px-2 text-gray-800 ml-1 bg-yellow-400 rounded-full">
                  {count}
                </span>
            </div>
          ) : (
            <button
              onClick={() => cartButton()}
              type="button"
              className="h-8 w-8 border border-transparent text-sm leading-4 font-medium w-full shadow-sm text-white hover:bg-teal-100 "
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                  <path d="M 4 7 C 3.448 7 3 7.448 3 8 C 3 8.552 3.448 9 4 9 L 6.21875 9 L 8.84375 19.5 C 9.06675 20.39 9.86325 21 10.78125 21 L 13 21 L 22 21 L 23.25 21 C 24.152 21 24.91825 20.40125 25.15625 19.53125 L 27.75 10 L 25.65625 10 L 23.25 19 L 10.78125 19 L 8.15625 8.5 C 7.93425 7.61 7.13675 7 6.21875 7 L 4 7 z M 22 21 C 20.35499 21 19 22.35499 19 24 C 19 25.64501 20.35499 27 22 27 C 23.64501 27 25 25.64501 25 24 C 25 22.35499 23.64501 21 22 21 z M 13 21 C 11.35499 21 10 22.35499 10 24 C 10 25.64501 11.35499 27 13 27 C 14.64501 27 16 25.64501 16 24 C 16 22.35499 14.64501 21 13 21 z M 16 7 L 16 10 L 13 10 L 13 12 L 16 12 L 16 15 L 18 15 L 18 12 L 21 12 L 21 10 L 18 10 L 18 7 L 16 7 z M 13 23 C 13.564128 23 14 23.435872 14 24 C 14 24.564128 13.564128 25 13 25 C 12.435872 25 12 24.564128 12 24 C 12 23.435872 12.435872 23 13 23 z M 22 23 C 22.564128 23 23 23.435872 23 24 C 23 24.564128 22.564128 25 22 25 C 21.435872 25 21 24.564128 21 24 C 21 23.435872 21.435872 23 22 23 z" overflow="visible" font-family="Sans"/>
              </svg>
            </button>
          )}
      </div>
    </div>
  );
};

export default Product;